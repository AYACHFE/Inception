# Use an Ubuntu image as the base
FROM ubuntu:18.04

# Install dependencies
RUN apt-get update && \
    apt-get install -y \
    gcc \
    libc6-dev \
    make \
    openssl \
    libssl-dev \
    libpcre3 \
    libpcre3-dev \
    zlib1g \
    zlib1g-dev \
    wget

# Define environment variable
ENV NGINX_VERSION 1.21.1

RUN wget http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz
RUN tar -zxf nginx-${NGINX_VERSION}.tar.gz
RUN cd nginx-${NGINX_VERSION} && \
    ./configure \
    --sbin-path=/usr/local/nginx/nginx \
    --conf-path=/usr/local/nginx/nginx.conf \
    --pid-path=/usr/local/nginx/nginx.pid \
    --with-pcre \
    --with-http_ssl_module
RUN cd nginx-${NGINX_VERSION} && \
    ./configure \
    --sbin-path=/usr/local/nginx/nginx \
    --conf-path=/usr/local/nginx/nginx.conf \
    --pid-path=/usr/local/nginx/nginx.pid \
    --with-pcre \
    --with-http_ssl_module && \
    make && \
    make install

COPY /website /usr/local/nginx/website

# Expose ports
EXPOSE 80 8080



# Start Nginx when the container is run
CMD ["/usr/local/nginx/nginx", "-g", "daemon off;"]